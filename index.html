<!doctype html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <title>オリジナルメッセージ入りのバースデーケーキを作る</title>
</head>

<canvas id="cv1" width="500" height="500"></canvas>
<!--
<style>
  canvas {
    display: none !important;
  }
</style>
-->

<script>
var cvs = document.getElementById("cv1");
var ctx  = cvs.getContext("2d");

let cakeRadio = document.getElementsByName('cake');

function cakeCheck() {
  for (let i = 0; i < cakeRadio.length; i++) {
    if (cakeRadio.item(i).checked) {
      return cakeRadio.item(i).value;
    }
  }
}

function setCake() {
  var cake = cakeCheck();
  var image = new Image();
  image.src = "./images/" + cake + "sample.jpg";
  ctx.drawImage(image, 0, 0, 500, 500);
}

function setMessage() {
  var message = document.getElementById("messageText").value;
  ctx.font = '32px serif';
  ctx.fillStyle = '#404040';
  ctx.textBaseline = 'center';
  ctx.textAlign = 'center';
  ctx.fillText(message, 100, 100);
  console.log(message);
}

function convertCanvasToImage() {
  setCake();
  setMessage();
  document.getElementById("newImg").src = cvs.toDataURL();
}
</script>

<body>
  オリジナルメッセージ入りのバースデーケーキ（画像）を作りましょう♪
  <br><br>
  Step1. まずは、ベースとなるケーキを選びましょう！<br>
            ケーキの下にあるボタンをクリックして選んでね！

  <table border="0" cellspacing="5" cellpadding="5">
  <tr>
  <td><img src = "./images/cake-1.jpg" width="200" height="200"></td>
  <td><img src = "./images/cake-1.jpg" width="200" height="200"></td>
  <td><img src = "./images/cake-1.jpg" width="200" height="200"></td>
  <td><img src = "./images/cake-1.jpg" width="200" height="200"></td>
  </tr>
  <tr>
  <td><input type="radio" name="cake" value="cake-1">↑これにする！</td>
  <td><input type="radio" name="cake" value="cake-2">↑こっちが良いかな！</td>
  <td><input type="radio" name="cake" value="cake-3">↑このケーキがいい！</td>
  <td><input type="radio" name="cake" value="cake-4">↑やっぱこれでしょ！</td>
  </tr>
  </table>
  <br><br>
  Step2. 次に、チョコプレートの〇〇部分に描くメッセージを入力しましょう！<br>
            下の枠内に入力してね！（できるだけ短めが良いかも）
  <br>
  <textarea id="messageText" placeholder="〇〇ちゃん"></textarea>
  <style>
    textarea{
      width:100%
      height:100px;
    }
  </style>
  <br><br>
  Step3. 最後に、下の「バースデーケーキを作る！」ボタンを押して完成！

  <form>
    <input type="button" value="バースデーケーキを作る！" onclick="convertCanvasToImage()">
  </form>

  <div><img id="newImg">  
  </div>
  <br><br>
  作成された画像は右クリック(PC)またはタップ長押し(スマートフォン)で保存できます☆<br>
  保存した画像をLINEやメールなどでお友達に送ってみてね！
</body>
